{
  "$schema": "https://ui.shadcn.com/schema/registry-item.json",
  "name": "video-player",
  "type": "registry:component",
  "description": "A video player component for shadcn/ui. Easily create a video player with a progress bar, volume control, and fullscreen toggle.",
  "dependencies": [
    "motion",
    "lucide-react"
  ],
  "registryDependencies": [
    "button",
    "slider"
  ],
  "files": [
    {
      "path": "registry/new-york/components/video-player/video-player.tsx",
      "content": "\"use client\";\nimport type React from \"react\";\n\nimport \"@/registry/new-york/styles/video-player.css\";\n\nimport { VideoPlayerBuffer } from \"@/registry/new-york/components/video-player/video-player-buffer\";\nimport { VideoPlayerControls } from \"@/registry/new-york/components/video-player/video-player-controls\";\nimport { VideoPlayerIndicator } from \"@/registry/new-york/components/video-player/video-player-indicator\";\nimport { VideoPlayerProgressBar } from \"@/registry/new-york/components/video-player/video-player-progress-bar\";\nimport { useVideoPlayer } from \"@/registry/new-york/hooks/useVideoPlayer\";\n\nexport interface VideoPlayerProps {\n    /** @public (required) Source of the video */\n    src:\n        | string\n        | {\n              \"2160p\"?: string;\n              \"1440p\"?: string;\n              \"1080p\"?: string;\n              \"720p\"?: string;\n              \"480p\"?: string;\n              \"360p\"?: string;\n              \"240p\"?: string;\n          };\n    /** @public (optional) Whether to autoplay the video */\n    autoPlay?: boolean;\n    /** @public (optional) Thumbnail image for the video */\n    thumbnail?: string;\n    /** @public (optional) Time at which to display the thumbnail */\n    thumbnailTime?: number;\n    /** @public (optional) Subtitles for the video */\n    subtitles?: {\n        src: string;\n        lang: string;\n        label: string;\n    }[];\n}\n\nconst VideoPlayer: React.FC<VideoPlayerProps> = ({\n    subtitles,\n    src,\n    autoPlay = false,\n    thumbnail,\n    thumbnailTime,\n}) => {\n    const {\n        playerRef,\n        containerRef,\n        playing,\n        indicator,\n        isBuffering,\n        volume,\n        muted,\n        progress,\n        displayThumb,\n        loadedProgress,\n        isFullscreen,\n        toggleFullscreen,\n        handleProgress,\n        handlePlay,\n        handlePause,\n        handlePlayPause,\n        handleVolumeChange,\n        handleWaiting,\n        handleCanPlay,\n        seek,\n        setMuted,\n    } = useVideoPlayer({\n        src,\n        autoPlay,\n        thumbnail,\n        thumbnailTime,\n    });\n\n    return (\n        <div className=\"w-full max-w-2xl mx-auto overflow-hidden\">\n            <div ref={containerRef} className=\"relative\">\n                <video\n                    ref={playerRef}\n                    src={src as string}\n                    className=\"w-full min-h-72 bg-muted aspect-video\"\n                    controls={false}\n                    poster={displayThumb || undefined}\n                    crossOrigin=\"anonymous\"\n                    onTimeUpdate={handleProgress}\n                    onLoadedMetadata={handleProgress}\n                    onPlay={handlePlay}\n                    onPause={handlePause}\n                    onClick={handlePlayPause}\n                    onWaiting={handleWaiting}\n                    onCanPlay={handleCanPlay}\n                    onCanPlayThrough={handleCanPlay}\n                    muted={muted}\n                >\n                    <track kind=\"captions\" srcLang=\"en\" label=\"English\" />\n                    {subtitles?.map((sub) => (\n                        <track\n                            key={`${sub.src}-${sub.lang}`}\n                            src={sub.src}\n                            kind=\"captions\"\n                            label={sub.label}\n                            srcLang={sub.lang}\n                        />\n                    ))}\n                </video>\n\n                <VideoPlayerBuffer isBuffering={isBuffering} />\n\n                <VideoPlayerIndicator indicator={indicator} playing={playing} />\n\n                <VideoPlayerProgressBar\n                    progress={progress}\n                    loadedProgress={loadedProgress}\n                    playerRef={playerRef as React.RefObject<HTMLVideoElement>}\n                    duration={playerRef.current?.duration || 0}\n                    onSeek={seek}\n                />\n\n                <VideoPlayerControls\n                    playing={playing}\n                    volume={volume}\n                    muted={muted}\n                    isFullscreen={isFullscreen}\n                    toggleFullscreen={toggleFullscreen}\n                    onPlayPause={handlePlayPause}\n                    onVolumeChange={handleVolumeChange}\n                    onMuteToggle={() => setMuted(!muted)}\n                />\n            </div>\n        </div>\n    );\n};\n\nexport { VideoPlayer };\n",
      "type": "registry:ui",
      "target": "components/video-player/video-player.tsx"
    },
    {
      "path": "registry/new-york/components/video-player/video-player-buffer.tsx",
      "content": "\"use client\";\n\nimport { AnimatePresence, motion } from \"motion/react\";\n\ninterface VideoPlayerBufferProps {\n    isBuffering: boolean;\n}\n\nexport const VideoPlayerBuffer: React.FC<VideoPlayerBufferProps> = ({\n    isBuffering,\n}) => {\n    return (\n        <AnimatePresence>\n            {isBuffering && (\n                <motion.div\n                    className=\"absolute inset-0 flex items-center justify-center bg-black/20 pointer-events-none\"\n                    initial={{ opacity: 0 }}\n                    animate={{ opacity: 1 }}\n                    exit={{ opacity: 0 }}\n                    transition={{ duration: 0.2 }}\n                >\n                    <div className=\"relative\">\n                        <motion.div\n                            className=\"w-16 h-16 border-4 border-white/20 border-t-white rounded-full\"\n                            animate={{ rotate: 360 }}\n                            transition={{\n                                duration: 1,\n                                repeat: Infinity,\n                                ease: \"linear\",\n                            }}\n                        />\n                    </div>\n                </motion.div>\n            )}\n        </AnimatePresence>\n    );\n};\n",
      "type": "registry:ui",
      "target": "components/video-player/video-player-buffer.tsx"
    },
    {
      "path": "registry/new-york/components/video-player/video-player-controls.tsx",
      "content": "\"use client\";\n\nimport type React from \"react\";\n\nimport {\n    Maximize,\n    Minimize,\n    Pause,\n    Play,\n    Volume1,\n    Volume2,\n    VolumeOff,\n} from \"lucide-react\";\nimport { motion } from \"motion/react\";\n\nimport { Button } from \"@/shadcn/components/ui/button\";\nimport { Slider } from \"@/shadcn/components/ui/slider\";\n\nconst MotionButton = motion.create(Button);\n\ninterface VideoPlayerControlsProps {\n    playing: boolean;\n    volume: number;\n    muted: boolean;\n    isFullscreen: boolean;\n    toggleFullscreen: () => void;\n    onPlayPause: () => void;\n    onVolumeChange: (value: number[]) => void;\n    onMuteToggle: () => void;\n}\n\nexport const VideoPlayerControls: React.FC<VideoPlayerControlsProps> = ({\n    playing,\n    volume,\n    muted,\n    isFullscreen,\n    toggleFullscreen,\n    onPlayPause,\n    onVolumeChange,\n    onMuteToggle,\n}) => {\n    return (\n        <div className=\"absolute bottom-2 flex items-center gap-4 justify-between w-full px-3\">\n            {/* Left Controls */}\n            <div className=\"flex items-center justify-start gap-2\">\n                {/* Play Button */}\n                <MotionButton\n                    variant=\"ghost\"\n                    className=\"rounded-full !bg-accent/60 hover:!bg-accent/70 transition-all duration-300 ease-in\"\n                    size={\"icon-lg\"}\n                    whileTap={{\n                        scale: 0.9,\n                    }}\n                    transition={{\n                        duration: 0.01,\n                        ease: \"linear\",\n                    }}\n                    onClick={onPlayPause}\n                >\n                    {playing ? (\n                        <Pause className=\"size-5\" />\n                    ) : (\n                        <Play className=\"size-5\" />\n                    )}\n                </MotionButton>\n\n                {/* Volume Slider */}\n                <motion.div\n                    className=\"relative bg-accent/60 hover:bg-accent/70 transition-all duration-300 ease-in rounded-full overflow-hidden hover:pr-2\"\n                    whileHover={{\n                        width: \"120px\",\n                    }}\n                    transition={{\n                        ease: \"linear\",\n                        duration: 0.1,\n                    }}\n                >\n                    {muted || volume < 0.01 ? (\n                        <Button\n                            variant=\"ghost\"\n                            className=\"rounded-full hover:!bg-transparent\"\n                            size={\"icon-sm\"}\n                            onClick={onMuteToggle}\n                        >\n                            <VolumeOff className=\"size-5\" />\n                        </Button>\n                    ) : volume < 0.5 ? (\n                        <Button\n                            variant=\"ghost\"\n                            className=\"rounded-full hover:!bg-transparent\"\n                            size={\"icon-sm\"}\n                            onClick={onMuteToggle}\n                        >\n                            <Volume1 className=\"size-5\" />\n                        </Button>\n                    ) : (\n                        <Button\n                            variant=\"ghost\"\n                            className=\"rounded-full hover:!bg-transparent\"\n                            size={\"icon-sm\"}\n                            onClick={onMuteToggle}\n                        >\n                            <Volume2 className=\"size-5\" />\n                        </Button>\n                    )}\n\n                    <div className=\"absolute left-10 w-19 top-0 bottom-0 my-auto flex items-center pr-2\">\n                        <Slider\n                            value={[volume * 100]}\n                            onValueChange={onVolumeChange}\n                            min={0}\n                            max={100}\n                            step={1}\n                            className=\"w-full h-1 volume-slider\"\n                        />\n                    </div>\n                </motion.div>\n            </div>\n\n            {/* Right Controls */}\n            <div className=\"flex items-center gap-2\">\n                <MotionButton\n                    variant=\"ghost\"\n                    className=\"rounded-full !bg-accent/60 hover:!bg-accent/70 transition-all duration-300 ease-in\"\n                    size={\"icon-sm\"}\n                    whileTap={{\n                        scale: 0.9,\n                    }}\n                    transition={{\n                        duration: 0.01,\n                        ease: \"linear\",\n                    }}\n                    onClick={toggleFullscreen}\n                    aria-label={\n                        isFullscreen ? \"Exit fullscreen\" : \"Enter fullscreen\"\n                    }\n                >\n                    {isFullscreen ? (\n                        <Minimize className=\"size-5\" />\n                    ) : (\n                        <Maximize className=\"size-5\" />\n                    )}\n                </MotionButton>\n            </div>\n        </div>\n    );\n};\n",
      "type": "registry:ui",
      "target": "components/video-player/video-player-controls.tsx"
    },
    {
      "path": "registry/new-york/components/video-player/video-player-indicator.tsx",
      "content": "\"use client\";\nimport type React from \"react\";\n\nimport {\n    ChevronLeft,\n    ChevronRight,\n    Pause,\n    Play,\n    Volume1,\n    Volume2,\n} from \"lucide-react\";\nimport { AnimatePresence, motion } from \"motion/react\";\n\ntype IndicatorType =\n    | \"play\"\n    | \"pause\"\n    | \"volume-up\"\n    | \"volume-down\"\n    | \"seek-forward\"\n    | \"seek-backward\"\n    | null;\n\ninterface VideoPlayerIndicatorProps {\n    indicator: IndicatorType;\n    playing: boolean;\n}\n\nexport const VideoPlayerIndicator: React.FC<VideoPlayerIndicatorProps> = ({\n    indicator,\n    playing,\n}) => {\n    return (\n        <AnimatePresence>\n            {indicator === \"play\" || indicator === \"pause\" ? (\n                <motion.div\n                    className=\"absolute inset-0 flex items-center justify-center pointer-events-none\"\n                    initial={{ opacity: 0, scale: 0.8 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    exit={{ opacity: 0, scale: 0.8 }}\n                    transition={{ duration: 0.3 }}\n                >\n                    <div className=\"bg-accent/50 rounded-full p-4\">\n                        {playing ? (\n                            <Play className=\"size-12 text-white \" />\n                        ) : (\n                            <Pause className=\"size-12 text-white \" />\n                        )}\n                    </div>\n                </motion.div>\n            ) : indicator === \"volume-down\" || indicator === \"volume-up\" ? (\n                <motion.div\n                    className=\"absolute inset-0 flex items-center justify-center pointer-events-none\"\n                    initial={{ opacity: 0, scale: 0.8 }}\n                    animate={{ opacity: 1, scale: 1 }}\n                    exit={{ opacity: 0, scale: 0.8 }}\n                    transition={{ duration: 0.3 }}\n                >\n                    <div className=\"bg-accent/50 rounded-full p-4\">\n                        {indicator === \"volume-down\" ? (\n                            <Volume1 className=\"size-12 text-white \" />\n                        ) : (\n                            <Volume2 className=\"size-12 text-white \" />\n                        )}\n                    </div>\n                </motion.div>\n            ) : indicator === \"seek-forward\" ? (\n                <div className=\"absolute inset-0 flex items-center justify-end pointer-events-none\">\n                    <motion.div\n                        className=\"flex items-center gap-0\"\n                        initial={{\n                            opacity: 0,\n                            x: -10,\n                        }}\n                        animate={{\n                            opacity: 1,\n                            x: 0,\n                        }}\n                        exit={{\n                            opacity: 0,\n                        }}\n                    >\n                        <span className=\"text-lg font-medium\">+5</span>\n                        <ChevronRight className=\"size-10 text-white\" />\n                    </motion.div>\n                </div>\n            ) : indicator === \"seek-backward\" ? (\n                <div className=\"absolute inset-0 flex items-center justify-start pointer-events-none\">\n                    <motion.div\n                        className=\"flex items-center gap-0\"\n                        initial={{\n                            opacity: 0,\n                            x: 10,\n                        }}\n                        animate={{\n                            opacity: 1,\n                            x: 0,\n                        }}\n                        exit={{\n                            opacity: 0,\n                        }}\n                    >\n                        <ChevronLeft className=\"size-10 text-white\" />\n                        <span className=\"text-lg font-medium\">+5</span>\n                    </motion.div>\n                </div>\n            ) : null}\n        </AnimatePresence>\n    );\n};\n",
      "type": "registry:ui",
      "target": "components/video-player/video-player-indicator.tsx"
    },
    {
      "path": "registry/new-york/components/video-player/video-player-progress-bar.tsx",
      "content": "\"use client\";\nimport { useCallback, useEffect, useRef, useState } from \"react\";\nimport type React from \"react\";\n\nimport { motion } from \"motion/react\";\n\ninterface VideoPlayerProgressBarProps {\n    progress: number;\n    loadedProgress: number;\n    playerRef: React.RefObject<HTMLVideoElement>;\n    duration: number;\n    onSeek: (e: React.MouseEvent<HTMLDivElement>) => void;\n}\n\nconst THROTTLE_DELAY = 200;\nconst MAX_CACHE_SIZE = 50;\n\nexport const VideoPlayerProgressBar: React.FC<VideoPlayerProgressBarProps> = ({\n    progress,\n    loadedProgress,\n    playerRef,\n    duration,\n    onSeek,\n}) => {\n    const [hoverTime, setHoverTime] = useState<number>(0);\n    const [hoverPosition, setHoverPosition] = useState<number>(0);\n    const [isCapturing, setIsCapturing] = useState<boolean>(false);\n    const [isInitialized, setIsInitialized] = useState<boolean>(false);\n    const [_isHovering, setIsHovering] = useState<boolean>(false);\n\n    const leaveTimeoutRef = useRef<NodeJS.Timeout>(null);\n    const canvasRef = useRef<HTMLCanvasElement>(null);\n    const previewVideoRef = useRef<HTMLVideoElement>(null);\n    const thumbCache = useRef<Map<number, HTMLCanvasElement>>(new Map());\n    const lastCaptureTime = useRef<number>(0);\n\n    const initializePreviewVideo = useCallback(() => {\n        if (isInitialized || !playerRef.current) return;\n\n        const mainVideo = playerRef.current;\n        const clonedVideo = mainVideo.cloneNode(true) as HTMLVideoElement;\n        clonedVideo.muted = true;\n        clonedVideo.playsInline = true;\n        clonedVideo.style.cssText =\n            \"display:none;position:absolute;width:1px;height:1px;opacity:0;pointer-events:none\";\n\n        if (mainVideo.parentElement) {\n            mainVideo.parentElement.appendChild(clonedVideo);\n        }\n\n        previewVideoRef.current = clonedVideo;\n        setIsInitialized(true);\n    }, [isInitialized, playerRef]);\n\n    const addToCache = useCallback(\n        (time: number, canvas: HTMLCanvasElement) => {\n            if (thumbCache.current.size >= MAX_CACHE_SIZE) {\n                const firstKey = thumbCache.current.keys().next().value;\n                thumbCache.current.delete(firstKey as number);\n            }\n\n            thumbCache.current.set(time, canvas);\n        },\n        [],\n    );\n\n    const captureThumb = useCallback(\n        (time: number) => {\n            if (!previewVideoRef.current || !canvasRef.current) return;\n\n            const video = previewVideoRef.current;\n            const canvas = canvasRef.current;\n            const ctx = canvas.getContext(\"2d\");\n\n            if (!ctx) return;\n\n            const roundedTime = Math.floor(time);\n\n            // Check if thumbnail is already cached\n            if (thumbCache.current.has(roundedTime)) {\n                const cachedCanvas = thumbCache.current.get(roundedTime);\n\n                ctx.clearRect(0, 0, canvas.width, canvas.height);\n                ctx.drawImage(cachedCanvas as CanvasImageSource, 0, 0);\n                setIsCapturing(false);\n                return;\n            }\n\n            setIsCapturing(true);\n            video.currentTime = time;\n\n            const handleSeeked = () => {\n                requestAnimationFrame(() => {\n                    // Use smaller resolution for preview (faster rendering)\n                    const previewWidth = 160;\n                    const previewHeight = 90;\n\n                    canvas.width = previewWidth;\n                    canvas.height = previewHeight;\n\n                    // Draw scaled down for better performance\n                    ctx.drawImage(video, 0, 0, previewWidth, previewHeight);\n\n                    // Cache the canvas\n                    const cachedCanvas = document.createElement(\"canvas\");\n                    cachedCanvas.width = previewWidth;\n                    cachedCanvas.height = previewHeight;\n                    const cachedCtx = cachedCanvas.getContext(\"2d\");\n                    if (cachedCtx) {\n                        cachedCtx.drawImage(canvas, 0, 0);\n                        addToCache(roundedTime, cachedCanvas);\n                    }\n\n                    video.removeEventListener(\"seeked\", handleSeeked);\n                    setIsCapturing(false);\n                });\n            };\n\n            video.addEventListener(\"seeked\", handleSeeked);\n        },\n        [addToCache],\n    );\n\n    const handleProgressHover = (e: React.MouseEvent<HTMLDivElement>) => {\n        // Clear any pending hide timeout\n        if (leaveTimeoutRef.current) {\n            clearTimeout(leaveTimeoutRef.current);\n            leaveTimeoutRef.current = null;\n        }\n\n        if (!playerRef.current || !duration || !Number.isFinite(duration))\n            return;\n\n        setIsHovering(true);\n\n        const now = Date.now();\n        if (now - lastCaptureTime.current < THROTTLE_DELAY) return;\n        lastCaptureTime.current = now;\n\n        if (!isInitialized) {\n            initializePreviewVideo();\n        }\n\n        const rect = e.currentTarget.getBoundingClientRect();\n        const percentage = (e.clientX - rect.left) / rect.width;\n        const time = percentage * duration;\n        const position = e.clientX - rect.left;\n\n        if (!Number.isFinite(time) || time < 0) return;\n\n        setHoverTime(time);\n        setHoverPosition(position);\n\n        // Capture thumbnail at this time\n        captureThumb(time);\n    };\n\n    const handleProgressLeave = () => {\n        // Clear any existing timeout\n        if (leaveTimeoutRef.current) {\n            clearTimeout(leaveTimeoutRef.current);\n        }\n\n        // Delay hiding to allow moving to preview thumbnail\n        leaveTimeoutRef.current = setTimeout(() => {\n            setHoverTime(0);\n            setHoverPosition(0);\n            setIsCapturing(false);\n            setIsHovering(false);\n            leaveTimeoutRef.current = null;\n        }, 200); // 200ms delay\n    };\n\n    const handlePreviewEnter = () => {\n        // Cancel hide when hovering over preview\n        if (leaveTimeoutRef.current) {\n            clearTimeout(leaveTimeoutRef.current);\n            leaveTimeoutRef.current = null;\n        }\n    };\n\n    const handlePreviewLeave = () => {\n        // Hide preview when leaving preview area\n        setHoverTime(0);\n        setIsHovering(false);\n    };\n\n    const formatTime = (seconds: number): string => {\n        const mins = Math.floor(seconds / 60);\n        const secs = Math.floor(seconds % 60);\n        return `${mins}:${secs.toString().padStart(2, \"0\")}`;\n    };\n\n    useEffect(() => {\n        return () => {\n            if (previewVideoRef.current?.parentElement) {\n                previewVideoRef.current.parentElement.removeChild(\n                    previewVideoRef.current,\n                );\n                setIsInitialized(false);\n            }\n            if (leaveTimeoutRef.current) {\n                clearTimeout(leaveTimeoutRef.current);\n                leaveTimeoutRef.current = null;\n            }\n            thumbCache.current.clear();\n        };\n    }, []);\n\n    return (\n        <div\n            className=\"absolute bottom-14 left-0 w-full px-3 cursor-pointer\"\n            onClick={onSeek}\n            onKeyDown={(e) => {\n                if (e.key === \"Enter\" || e.key === \" \") {\n                    onSeek(e as unknown as React.MouseEvent<HTMLDivElement>);\n                }\n            }}\n            onMouseMove={handleProgressHover}\n            onMouseLeave={handleProgressLeave}\n            role=\"button\"\n            tabIndex={0}\n            aria-label=\"Video Progress Bar\"\n        >\n            <div className=\"relative w-full h-1 bg-accent/60 hover:h-2 transition-all duration-300 ease-in\">\n                {hoverTime !== 0 && (\n                    <motion.div\n                        layout\n                        transition={{\n                            ease: \"linear\",\n                        }}\n                        animate={{\n                            left: `${hoverPosition}px`,\n                            transform: `translateX(-50%)`,\n                        }}\n                        initial={false}\n                        className=\"absolute bottom-full mb-2 pointer-events-none z-20\"\n                        style={{}}\n                        onMouseEnter={handlePreviewEnter}\n                        onMouseLeave={handlePreviewLeave}\n                    >\n                        <div className=\"bg-black rounded overflow-hidden shadow-lg\">\n                            <canvas\n                                ref={canvasRef}\n                                className=\"w-32 h-18 object-cover\"\n                                style={{\n                                    display: isCapturing ? \"none\" : \"block\",\n                                }}\n                            />\n                            {isCapturing && (\n                                <div className=\"w-32 h-18 bg-gray-800 flex items-center justify-center\">\n                                    <div className=\"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin\" />\n                                </div>\n                            )}\n                            <div className=\"px-2 py-1 text-white text-xs text-center bg-black/80\">\n                                {formatTime(hoverTime)}\n                            </div>\n                        </div>\n                    </motion.div>\n                )}\n\n                <motion.div\n                    className=\"absolute inset-0 bg-white/30 pointer-events-none\"\n                    animate={{\n                        width: `${loadedProgress * 100}%`,\n                    }}\n                    initial={false}\n                    transition={{\n                        type: \"spring\",\n                        stiffness: 250,\n                        damping: 25,\n                        ease: [0.65, 0.815, 0.735, 0.395],\n                    }}\n                />\n\n                <motion.div\n                    className=\"relative h-full bg-primary pointer-events-none\"\n                    animate={{\n                        width: `${progress * 100}%`,\n                    }}\n                    initial={false}\n                    transition={{\n                        type: \"spring\",\n                        stiffness: 250,\n                        damping: 25,\n                        ease: [0.65, 0.815, 0.735, 0.395],\n                    }}\n                    whileHover={{\n                        height: \".5rem\",\n                    }}\n                />\n            </div>\n        </div>\n    );\n};\n",
      "type": "registry:ui",
      "target": "components/video-player/video-player-progress-bar.tsx"
    },
    {
      "path": "registry/new-york/hooks/useVideoPlayer.ts",
      "content": "\"use client\";\nimport { useCallback, useEffect, useMemo, useRef, useState } from \"react\";\nimport type React from \"react\";\n\nimport { useEventListener } from \"@/registry/new-york/hooks/useEventListener\";\n\ntype IndicatorType =\n    | \"play\"\n    | \"pause\"\n    | \"volume-up\"\n    | \"volume-down\"\n    | \"seek-forward\"\n    | \"seek-backward\"\n    | null;\n\ninterface UseVideoPlayerProps {\n    src:\n        | string\n        | {\n              \"2160p\"?: string;\n              \"1440p\"?: string;\n              \"1080p\"?: string;\n              \"720p\"?: string;\n              \"480p\"?: string;\n              \"360p\"?: string;\n              \"240p\"?: string;\n          };\n    autoPlay?: boolean;\n    thumbnail?: string;\n    thumbnailTime?: number;\n}\n\nexport type UseVideoPlayerReturn = ReturnType<typeof useVideoPlayer>;\n\nexport const useVideoPlayer = ({\n    src,\n    autoPlay = false,\n    thumbnail,\n    thumbnailTime,\n}: UseVideoPlayerProps) => {\n    const [playing, setPlaying] = useState(autoPlay);\n    const [indicator, setIndicator] = useState<IndicatorType>(null);\n    const [isBuffering, setIsBuffering] = useState(false);\n    const [volume, setVolume] = useState<number>(0.5);\n    const [muted, setMuted] = useState(false);\n    const [progress, setProgress] = useState<number>(0);\n    const [duration, setDuration] = useState(0);\n    const [currentTime, setCurrentTime] = useState(0);\n    const [capturedThumbnail, setCapturedThumbnail] = useState<string | null>(\n        null,\n    );\n    const [loadedProgress, setLoadedProgress] = useState<number>(0);\n    const [isFullscreen, setIsFullscreen] = useState(false);\n\n    const playerRef = useRef<HTMLVideoElement>(null);\n    const indicatorRef = useRef<NodeJS.Timeout>(null);\n    const containerRef = useRef<HTMLDivElement>(null);\n\n    const captureThumbnail = useCallback(\n        (time: number = 0) => {\n            const videoSrc =\n                typeof src === \"string\"\n                    ? src\n                    : src[\"1080p\"] ||\n                      src[\"720p\"] ||\n                      src[\"480p\"] ||\n                      Object.values(src)[0];\n\n            if (!videoSrc) {\n                console.error(\"No valid video source found\");\n                return;\n            }\n\n            const previewVideo = document.createElement(\n                \"video\",\n            ) as HTMLVideoElement;\n\n            previewVideo.crossOrigin = \"anonymous\";\n            previewVideo.src = videoSrc;\n            previewVideo.currentTime = time;\n\n            const canvas = document.createElement(\"canvas\");\n            const ctx = canvas?.getContext(\"2d\");\n            if (!ctx) return;\n\n            const handleSeeked = () => {\n                requestAnimationFrame(() => {\n                    canvas.width = previewVideo.videoWidth || 0;\n                    canvas.height = previewVideo.videoHeight || 0;\n                    ctx.fillStyle = \"rgba(0, 0, 0, 1)\";\n                    ctx.fillRect(0, 0, canvas.width, canvas.height);\n                    ctx.drawImage(previewVideo, 0, 0);\n\n                    const imageData = canvas.toDataURL(\"image/png\");\n                    setCapturedThumbnail(imageData);\n\n                    previewVideo.removeEventListener(\"seeked\", handleSeeked);\n                    previewVideo.removeEventListener(\"error\", handleError);\n                    previewVideo.src = \"\";\n                });\n\n                canvas.remove();\n            };\n\n            const handleError = () => {\n                previewVideo.removeEventListener(\"seeked\", handleSeeked);\n                previewVideo.removeEventListener(\"error\", handleError);\n                console.error(\"Failed to load video for thumbnail capture\");\n            };\n\n            previewVideo.addEventListener(\"seeked\", handleSeeked);\n            previewVideo.addEventListener(\"error\", handleError);\n        },\n        [src],\n    );\n\n    const handleProgress = () => {\n        if (!playerRef.current) return;\n        const { currentTime: ct, duration: dur } =\n            playerRef.current as HTMLVideoElement;\n\n        setCurrentTime(ct);\n        setDuration(dur);\n        setProgress(dur ? ct / dur : 0);\n\n        updateLoadedProgress();\n    };\n\n    const showIndicator = (type: IndicatorType) => {\n        setIndicator(type);\n        if (indicatorRef.current) clearTimeout(indicatorRef.current);\n        indicatorRef.current = setTimeout(() => {\n            setIndicator(null);\n        }, 800);\n    };\n\n    const handleVolumeChange = (value: number[]) => {\n        if (!playerRef.current) return;\n        const newVolume = value[0] / 100;\n\n        if (newVolume < 0.01) {\n            setMuted(true);\n        } else {\n            setMuted(false);\n        }\n\n        showIndicator(\n            newVolume >= volume && volume !== 0 ? \"volume-up\" : \"volume-down\",\n        );\n        setVolume(newVolume);\n    };\n\n    const handlePlayPause = () => {\n        if (!playerRef.current) return;\n\n        if (playerRef.current.paused) {\n            playerRef.current.play();\n            setPlaying(true);\n        } else {\n            playerRef.current.pause();\n            setPlaying(false);\n        }\n\n        showIndicator(playing ? \"pause\" : \"play\");\n    };\n\n    const handleWaiting = () => setIsBuffering(true);\n    const handleCanPlay = () => setIsBuffering(false);\n\n    const seek = (e: React.MouseEvent<HTMLDivElement>) => {\n        if (!playerRef.current || !duration || !Number.isFinite(duration))\n            return;\n\n        const rect = (e.target as HTMLDivElement).getBoundingClientRect();\n        const percentage = (e.clientX - rect.left) / rect.width;\n\n        // fix: Validate percentage is between 0 and 1\n        const clampedPercentage = Math.max(0, Math.min(1, percentage));\n        const seekTime = clampedPercentage * duration;\n\n        // fix: Validate seekTime is finite before setting\n        if (!Number.isFinite(seekTime) || seekTime < 0) return;\n\n        setProgress(clampedPercentage);\n        playerRef.current.currentTime = seekTime;\n    };\n\n    const updateLoadedProgress = () => {\n        if (!playerRef.current) return;\n\n        const video = playerRef.current;\n        const buffered = video.buffered;\n\n        if (buffered.length > 0 && duration > 0) {\n            const bufferedEnd = buffered.end(buffered.length - 1);\n            const loaded = bufferedEnd / duration;\n            setLoadedProgress(loaded);\n        }\n    };\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n        if (e.code === \"Space\" && playerRef.current) {\n            e.preventDefault();\n            handlePlayPause();\n            return;\n        }\n\n        if (e.code === \"ArrowRight\" && playerRef.current) {\n            e.preventDefault();\n            playerRef.current.currentTime += 5;\n            showIndicator(\"seek-forward\");\n            return;\n        }\n\n        if (e.code === \"ArrowLeft\" && playerRef.current) {\n            e.preventDefault();\n            playerRef.current.currentTime -= 5;\n            showIndicator(\"seek-backward\");\n            return;\n        }\n\n        if (e.code === \"ArrowUp\" && playerRef.current) {\n            e.preventDefault();\n            const newVolume = Math.min(1, volume + 0.1);\n            handleVolumeChange([newVolume * 100]);\n            return;\n        }\n\n        if (e.code === \"ArrowDown\" && playerRef.current) {\n            e.preventDefault();\n            const newVolume = Math.max(0, volume - 0.1);\n            handleVolumeChange([newVolume * 100]);\n            return;\n        }\n    };\n\n    const toggleFullscreen = useCallback(() => {\n        if (!containerRef.current) return;\n\n        const container = containerRef.current;\n\n        if (!document.fullscreenElement) {\n            // Enter fullscreen\n            if (container.requestFullscreen) {\n                container.requestFullscreen();\n            } else if (\n                (\n                    container as unknown as {\n                        webkitRequestFullscreen?: () => void;\n                    }\n                ).webkitRequestFullscreen\n            ) {\n                // Safari\n                (\n                    container as unknown as {\n                        webkitRequestFullscreen: () => void;\n                    }\n                ).webkitRequestFullscreen();\n            } else if (\n                (container as unknown as { mozRequestFullScreen?: () => void })\n                    .mozRequestFullScreen\n            ) {\n                // Firefox\n                (\n                    container as unknown as { mozRequestFullScreen: () => void }\n                ).mozRequestFullScreen();\n            } else if (\n                (container as unknown as { msRequestFullscreen?: () => void })\n                    .msRequestFullscreen\n            ) {\n                // IE/Edge\n                (\n                    container as unknown as { msRequestFullscreen: () => void }\n                ).msRequestFullscreen();\n            }\n        } else {\n            // Exit fullscreen\n            if (document.exitFullscreen) {\n                document.exitFullscreen();\n            } else if (\n                (document as unknown as { webkitExitFullscreen?: () => void })\n                    .webkitExitFullscreen\n            ) {\n                (\n                    document as unknown as { webkitExitFullscreen: () => void }\n                ).webkitExitFullscreen();\n            } else if (\n                (document as unknown as { mozCancelFullScreen?: () => void })\n                    .mozCancelFullScreen\n            ) {\n                (\n                    document as unknown as { mozCancelFullScreen: () => void }\n                ).mozCancelFullScreen();\n            } else if (\n                (document as unknown as { msExitFullscreen?: () => void })\n                    .msExitFullscreen\n            ) {\n                (\n                    document as unknown as { msExitFullscreen: () => void }\n                ).msExitFullscreen();\n            }\n        }\n    }, []);\n\n    useEffect(() => {\n        if (!thumbnail) {\n            captureThumbnail(thumbnailTime ?? 10);\n        }\n    }, [thumbnail, thumbnailTime, captureThumbnail]);\n\n    useEffect(() => {\n        return () => {\n            if (indicatorRef.current) {\n                clearTimeout(indicatorRef.current);\n            }\n        };\n    }, []);\n\n    useEffect(() => {\n        if (playerRef.current) {\n            playerRef.current.volume = volume;\n        }\n    }, [volume]);\n\n    // Listen for fullscreen changes\n    useEffect(() => {\n        const handleFullscreenChange = () => {\n            setIsFullscreen(\n                !!(\n                    document.fullscreenElement ||\n                    (\n                        document as unknown as {\n                            webkitFullscreenElement?: Element;\n                        }\n                    ).webkitFullscreenElement ||\n                    (document as unknown as { mozFullScreenElement?: Element })\n                        .mozFullScreenElement ||\n                    (document as unknown as { msFullscreenElement?: Element })\n                        .msFullscreenElement\n                ),\n            );\n        };\n\n        document.addEventListener(\"fullscreenchange\", handleFullscreenChange);\n        document.addEventListener(\n            \"webkitfullscreenchange\",\n            handleFullscreenChange,\n        );\n        document.addEventListener(\n            \"mozfullscreenchange\",\n            handleFullscreenChange,\n        );\n        document.addEventListener(\"MSFullscreenChange\", handleFullscreenChange);\n\n        return () => {\n            document.removeEventListener(\n                \"fullscreenchange\",\n                handleFullscreenChange,\n            );\n            document.removeEventListener(\n                \"webkitfullscreenchange\",\n                handleFullscreenChange,\n            );\n            document.removeEventListener(\n                \"mozfullscreenchange\",\n                handleFullscreenChange,\n            );\n            document.removeEventListener(\n                \"MSFullscreenChange\",\n                handleFullscreenChange,\n            );\n        };\n    }, []);\n\n    useEventListener(\"keydown\", handleKeyDown);\n\n    const displayThumb = useMemo(\n        () => thumbnail || capturedThumbnail,\n        [thumbnail, capturedThumbnail],\n    );\n\n    const handlePlay = () => setPlaying(true);\n    const handlePause = () => setPlaying(false);\n\n    return {\n        playerRef,\n        containerRef,\n        playing,\n        indicator,\n        isBuffering,\n        volume,\n        muted,\n        progress,\n        duration,\n        currentTime,\n        displayThumb,\n        loadedProgress,\n        isFullscreen,\n        toggleFullscreen,\n        handleProgress,\n        handlePlay,\n        handlePause,\n        handlePlayPause,\n        handleVolumeChange,\n        handleWaiting,\n        handleCanPlay,\n        seek,\n        setMuted,\n        updateLoadedProgress,\n    };\n};\n",
      "type": "registry:hook"
    },
    {
      "path": "registry/new-york/hooks/useEventListener.ts",
      "content": "import { useEffect, useRef } from \"react\";\nimport type { RefObject } from \"react\";\n\nimport { useIsomorphicLayoutEffect } from \"@/registry/new-york/hooks/useIsomorphicLayoutEffect\";\n\n// MediaQueryList Event based useEventListener interface\nfunction useEventListener<K extends keyof MediaQueryListEventMap>(\n    eventName: K,\n    handler: (event: MediaQueryListEventMap[K]) => void,\n    element: RefObject<MediaQueryList>,\n    options?: boolean | AddEventListenerOptions,\n): void;\n\n// Window Event based useEventListener interface\nfunction useEventListener<K extends keyof WindowEventMap>(\n    eventName: K,\n    handler: (event: WindowEventMap[K]) => void,\n    element?: undefined,\n    options?: boolean | AddEventListenerOptions,\n): void;\n\n// Element Event based useEventListener interface\nfunction useEventListener<\n    K extends keyof HTMLElementEventMap & keyof SVGElementEventMap,\n    T extends Element = K extends keyof HTMLElementEventMap\n        ? HTMLDivElement\n        : SVGElement,\n>(\n    eventName: K,\n    handler:\n        | ((event: HTMLElementEventMap[K]) => void)\n        | ((event: SVGElementEventMap[K]) => void),\n    element: RefObject<T>,\n    options?: boolean | AddEventListenerOptions,\n): void;\n\n// Document Event based useEventListener interface\nfunction useEventListener<K extends keyof DocumentEventMap>(\n    eventName: K,\n    handler: (event: DocumentEventMap[K]) => void,\n    element: RefObject<Document>,\n    options?: boolean | AddEventListenerOptions,\n): void;\n\nfunction useEventListener<\n    KW extends keyof WindowEventMap,\n    KH extends keyof HTMLElementEventMap & keyof SVGElementEventMap,\n    KM extends keyof MediaQueryListEventMap,\n    T extends HTMLElement | SVGAElement | MediaQueryList = HTMLElement,\n>(\n    eventName: KW | KH | KM,\n    handler: (\n        event:\n            | WindowEventMap[KW]\n            | HTMLElementEventMap[KH]\n            | SVGElementEventMap[KH]\n            | MediaQueryListEventMap[KM]\n            | Event,\n    ) => void,\n    element?: RefObject<T>,\n    options?: boolean | AddEventListenerOptions,\n) {\n    // Create a ref that stores handler\n    const savedHandler = useRef(handler);\n\n    useIsomorphicLayoutEffect(() => {\n        savedHandler.current = handler;\n    }, [handler]);\n\n    useEffect(() => {\n        // Define the listening target\n        const targetElement: T | Window = element?.current ?? window;\n\n        if (!(targetElement && (targetElement?.addEventListener ?? false)))\n            return;\n\n        // Create event listener that calls handler function stored in ref\n        const listener: typeof handler = (event) => {\n            savedHandler.current(event);\n        };\n\n        targetElement.addEventListener(eventName, listener, options);\n\n        // Remove event listener on cleanup\n        return () => {\n            targetElement.removeEventListener(eventName, listener, options);\n        };\n    }, [eventName, element, options]);\n}\n\nexport { useEventListener };\n",
      "type": "registry:hook"
    },
    {
      "path": "registry/new-york/hooks/useWindowSize.ts",
      "content": "import { useState } from \"react\";\n\nimport { useEventListener } from \"@/registry/new-york/hooks/useEventListener\";\n\nconst useWindowSize = () => {\n    const [windowSize, setWindowSize] = useState({\n        width: typeof window !== \"undefined\" ? window.innerWidth : 0,\n        height: typeof window !== \"undefined\" ? window.innerHeight : 0,\n    });\n\n    const handleResize = () => {\n        setWindowSize({\n            width: window.innerWidth,\n            height: window.innerHeight,\n        });\n    };\n\n    useEventListener(\"resize\", handleResize);\n\n    return windowSize;\n};\n\nexport { useWindowSize };\n",
      "type": "registry:hook"
    },
    {
      "path": "registry/new-york/styles/video-player.css",
      "content": "@layer base {\n    [data-slot=\"slider\"],\n    [data-slot=\"slider-track\"] {\n        height: calc(var(--spacing) * 1) !important;\n    }\n\n    [data-slot=\"slider-track\"] {\n        background-color: color-mix(\n            in oklab,\n            var(--accent) 60%,\n            transparent\n        ) !important;\n    }\n\n    [data-slot=\"slider-thumb\"] {\n        width: calc(var(--spacing) * 2.5) !important;\n        height: calc(var(--spacing) * 2.5) !important;\n        background-color: var(--color-primary) !important;\n        border-radius: 50% !important;\n    }\n}\n",
      "type": "registry:style"
    }
  ]
}